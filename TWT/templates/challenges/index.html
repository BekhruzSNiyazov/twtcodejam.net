{# Main landing page. #}
{% extends 'base/base.html' %}
{% load socialaccount %}
{% load static %}

{% block stylesheets %}
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
{% endblock %}

{% block content %}
    {% include "base/navbar.html" %}

    {% if is_staff %}
        <p class="text-center text-white" style="margin-top: 10px">Hey {{ username }}, you have permission to create new challenges!
            <br>
            <a href="{% url 'home:new' %}">
                <button class="btn btn-success">
                    New
                </button>
            </a>
        </p>
    {% endif %}

    {# Display all challenges. #}

    {% if challenges %}
        <div class="jumbotron" style="margin-top: 2%; margin-left: 4%; margin-right: 4%">
        <h1 class="display-4">Challenges</h1>
        <p class="lead">Some text here talking about challenges</p>
        <hr class="my-4">

        <ul class="nav nav-pills flex-column flex-sm-row" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <a class="flex-sm-fill text-sm-center nav-link active" id="weekly-tab" data-toggle="tab" href="#weekly" role="tab" aria-controls="home" aria-selected="true">Weekly</a>
            </li>
            {% if is_helper %}
                <li class="nav-item" role="presentation">
                    <a class="flex-sm-fill text-sm-center nav-link" id="monthly-tab" data-toggle="tab" href="#monthly" role="tab" aria-controls="profile" aria-selected="false">Monthly</a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="flex-sm-fill text-sm-center nav-link" id="unreleased-tab" data-toggle="tab" href="#unreleased" role="tab" aria-controls="settings" aria-selected="false">Unreleased</a>
                </li>
            {% endif %}
        </ul>
        <br>
        <div class="tab-content">
            <div class="tab-pane fade show active" id="weekly" role="tabpanel" aria-labelledby="weekly-tab">
                {% for challenge in weekly_challenges %}
                    {% if forloop.first %}<div class="row">{% endif %}
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h1 class="card-title">{{ challenge.title }}</h1>
                            <hr class="my-1">
                            <p class="card-text text-muted">{{ challenge.short_desc }}</p>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-primary">Submit</button>
                            <a href="{% url 'home:view' challenge.id %}">
                                <button class="btn btn-primary">View</button>
                            </a>
                        </div>
                    </div>
                </div>
                {% if forloop.counter|divisibleby:2 %}</div><div class="row" style="margin-top: 10px;">{% endif %}
                {% if forloop.last %}</div>{% endif %}
                {% endfor %}
            </div>
            <div class="tab-pane fade" id="monthly" role="tabpanel" aria-labelledby="monthly-tab">
                {% for challenge in monthly_challenges %}
                    {% if forloop.first %}<div class="row">{% endif %}
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <h1 class="card-title">{{ challenge.title }}</h1>
                            <hr class="my-1">
                            <p class="card-text text-muted">{{ challenge.short_desc }}</p>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-primary">Submit</button>
                            <a href="{% url 'home:view' challenge.id %}">
                                <button class="btn btn-primary">View</button>
                            </a>
                        </div>
                    </div>
                </div>
                {% if forloop.counter|divisibleby:2 %}</div><div class="row" style="margin-top: 10px;">{% endif %}
                {% if forloop.last %}</div>{% endif %}
                {% endfor %}
            </div>
            {% if is_helper %}
                <div class="tab-pane fade" id="unreleased" role="tabpanel" aria-labelledby="unreleased-tab">
                    {% for challenge in unreleased_challenges.weekly_challenges %}
                        <h5 class="challenge-title">Weekly Challenges</h5>
                        {% if forloop.first %}<div class="row">{% endif %}
                    <div class="col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h1 class="card-title">{{ challenge.title }}</h1>
                                <hr class="my-1">
                                <p class="card-text text-muted">{{ challenge.short_desc }}</p>
                            </div>
                            <div class="card-footer">
                                <button class="btn btn-primary">Submit</button>
                                <a href="{% url 'home:view' challenge.id %}">
                                    <button class="btn btn-primary">View</button>
                                </a>
                            </div>
                        </div>
                    </div>
                    {% if forloop.counter|divisibleby:2 %}</div><div class="row" style="margin-top: 10px;">{% endif %}
                    {% if forloop.last %}</div>{% endif %}
                    {% endfor %}
                {% if unreleased_challenges.weekly_challenges %}
                <br>
                <hr>
                {% endif %}
                    {% for challenge in unreleased_challenges.monthly_challenges %}
                        <h5 class="challenge-title">Monthly Challenges</h5>
                        {% if forloop.first %}<div class="row">{% endif %}
                    <div class="col-sm-6">
                        <div class="card">
                            <div class="card-body">
                                <h1 class="card-title">{{ challenge.title }}</h1>
                                <hr class="my-1">
                                <p class="card-text text-muted">{{ challenge.short_desc }}</p>
                            </div>
                            <div class="card-footer">
                                <button class="btn btn-primary">Submit</button>
                                <a href="{% url 'home:view' challenge.id %}">
                                    <button class="btn btn-primary">View</button>
                                </a>
                            </div>
                        </div>
                    </div>
                    {% if forloop.counter|divisibleby:2 %}</div><div class="row" style="margin-top: 10px;">{% endif %}
                    {% if forloop.last %}</div>{% endif %}
                    {% endfor %}

                </div>
            {% endif %}
        </div>
    {% endif %}

{% endblock %}